<div id="kanban">
  <dx-scroll-view class="scrollable-board h-100" direction="horizontal" showScrollbar="always">
    <div class="list" *ngFor="let listTask of project.tasks;">

      <div class="list-task-name">
        <div class="list-title dx-theme-text-color">

          <span class="task-name-title" *ngIf="listTask.id !== lstTask?.id; else editLstTaskName">{{ listTask.name }}</span>
          <ng-template #editLstTaskName>
            <input #nameInput type="text" class="task-name-input" [value]="lstTask.name"
              (focusout)="onBlurEditLstTask($event)" (keydown.enter)="$event.target.blur()" />
          </ng-template>
          <span class="badge badge-pill badge-primary badge-custome">{{ listTask.task.length }}</span>

        </div>
        <div class="btn-edit-list-task-name" (click)="onClickEditLstTaskName(listTask)">
          <i class="fas fa-pencil-alt fa-size"></i>
        </div>
      </div>


      <dx-scroll-view class="scrollable-list" direction="vertical" showScrollbar="always">
        <dx-sortable class="sortable-cards" group="cardsGroup" handle=".can-drag" [data]="listTask"
          (onDragStart)="onTaskDragStart($event)" (onReorder)="onTaskDrop($event)" (onAdd)="onTaskDrop($event)">

          <div class="card can-drag dx-card dx-theme-text-color dx-theme-background-color"
            (click)="onClickEditTask(task)" *ngFor="let task of listTask.task">
            <div class="card-subject">{{ task.name }}</div>
            <div class="card-assignee">{{ task.statusTaskString }}</div>
          </div>

          <div id="addTask" class="card dx-card dx-theme-text-color dx-theme-background-color"
            (click)="onClickAddTask(listTask)">
            <div class="card-assignee">Add a task...</div>
          </div>
        </dx-sortable>
      </dx-scroll-view>
    </div>

    <div class="list list-add" (click)="onClickAddList($event)">
      <div class="list-add-title dx-theme-text-color">Add List ...</div>

      <div [(hidden)]="isHidenTextBox" class="add-list">
        <dx-text-box #addLstInput class="card-add dx-card dx-theme-text-color dx-theme-background-color"
          placeholder="Add list task title">
        </dx-text-box>
        <div class="btn-save">
          <i (click)="onSave($event)" class="far fa-check-square fa-2x"></i>
        </div>
      </div>

    </div>
  </dx-scroll-view>
</div>

<dx-popup title="Add Task" [showCloseButton]="true" width="1100" [(fullScreen)]="isFullScreen"
  [(visible)]="popupTaskVisible">
  <div *dxTemplate="let data of 'content'">
    <dx-scroll-view direction="vertical" [useNative]="true">

      <dx-validation-group #validationGroup>
        <div class="container-fluid">
          <div class="row">
            <div class="col-md-12">
              <div class="header">
                <dx-text-box [(value)]="task.name" placeholder="Task Title">
                  <dx-validator>
                    <dxi-validation-rule type="required">
                    </dxi-validation-rule>
                  </dx-validator>
                </dx-text-box>
              </div>
            </div>
          </div>
          <!-- ROW -->
          <div class="row">
            <!-- COL-9 -->
            <div class="col-md-9 body mt-3">
              <p><b>Description</b></p>
              <dx-html-editor valueType="html" height="209" [(value)]="task.description">
                <dxo-toolbar (multiline)="true">
                  <dxi-item formatName="bold"></dxi-item>
                  <dxi-item formatName="italic"></dxi-item>
                  <dxi-item formatName="underline"></dxi-item>
                  <dxi-item formatName="separator"></dxi-item>

                  <dxi-item formatName="orderedList"></dxi-item>
                  <dxi-item formatName="bulletList"></dxi-item>
                  <dxi-item formatName="separator"></dxi-item>

                  <dxi-item formatName="alignLeft"></dxi-item>
                  <dxi-item formatName="alignCenter"></dxi-item>
                  <dxi-item formatName="alignRight"></dxi-item>
                  <dxi-item formatName="separator"></dxi-item>

                  <dxi-item formatName="header" [formatValues]="[false, 1, 2, 3, 4, 5]"></dxi-item>
                  <dxi-item formatName="font"
                    [formatValues]="['Arial', 'Courier New', 'Georgia', 'Impact', 'Lucida Console', 'Tahoma', 'Times New Roman', 'Verdana']">
                  </dxi-item>
                  <dxi-item formatName="size" [formatValues]="['8pt', '10pt', '12pt', '14pt', '18pt', '24pt', '36pt']">
                  </dxi-item>
                  <dxi-item formatName="color"></dxi-item>
                  <dxi-item formatName="background"></dxi-item>
                  <dxi-item formatName="separator"></dxi-item>

                  <dxi-item formatName="link"></dxi-item>
                  <dxi-item formatName="image"></dxi-item>
                  <dxi-item formatName="separator"></dxi-item>

                  <dxi-item formatName="clear"></dxi-item>
                  <dxi-item formatName="strike"></dxi-item>
                  <dxi-item formatName="separator"></dxi-item>

                  <dxi-item formatName="codeBlock"></dxi-item>
                  <dxi-item formatName="blockquote"></dxi-item>
                  <dxi-item formatName="separator"></dxi-item>
                  <dxi-item formatName="undo"></dxi-item>
                  <dxi-item formatName="redo"></dxi-item>
                  <dxi-item formatName="separator"></dxi-item>
                </dxo-toolbar>

              </dx-html-editor>
            </div>
            <!-- END COL-9 -->

            <!-- COL-3 -->
            <div class="col-md-3">
              <p class="add-task-title mt-3">ADD TO TASK</p>
              <dx-button *ngIf="isEdit" id="todo" class="add-to-task-button" text="Todo" icon="todo" type="default"
                (onClick)="popoverTodoVisible = !popoverTodoVisible">
              </dx-button>

              <dx-button class="add-to-task-button" text="Member" icon="user" type="default">
              </dx-button>

              <dx-button id="status" class="add-to-task-button" text="Status" icon="tags" type="default"
                (onClick)="popoverStatusVisible = !popoverStatusVisible">
              </dx-button>


              <p class="add-task-title mt-3">ACTIONS</p>
              <dx-button class="add-to-task-button" text="Save" icon="save" type="default"
                (onClick)="submitTask($event)">
              </dx-button>
            </div>
            <!-- END COL-3 -->
          </div>
          <!-- END ROW -->
          <div class="row mt-3">
            <div class="col-md-12">
              <div class="todos mt-2">
                <dx-check-box [disabled]="true" [value]="true"></dx-check-box>
                <div class="name-todos">Disabled</div>
              </div>
              <div class="todos">
                <dx-check-box [disabled]="true" [value]="true"></dx-check-box>
                <div class="name-todos">Disabled</div>
              </div>
              <div class="todos">
                <dx-check-box [disabled]="true" [value]="true"></dx-check-box>
                <div class="name-todos">Disabled</div>
              </div>

            </div>
          </div>
        </div>

      </dx-validation-group>
    </dx-scroll-view>
  </div>
</dx-popup>

<dx-popover target="#status" position="bottom" [width]="200" [(visible)]="popoverStatusVisible">
  <div *dxTemplate="let data = model of 'content'">
    <p class="btn-title-add-to-task">Status</p>
    <dx-list [dataSource]="statusTask" selectionMode="single" [showSelectionControls]="true"
      [(selectedItemKeys)]="selectStatus" keyExpr="id">
    </dx-list>
  </div>
</dx-popover>

<dx-popover target="#todo" position="bottom" [width]="300" [(visible)]="popoverTodoVisible">
  <div *dxTemplate="let data = model of 'content'">
    <p class="btn-title-add-to-task">Add To-Do</p>
    <hr>
    <div class="form-group">
      <label class="lbl-title-add-to-task">Title: </label>
      <input #inputTodo type="text" class="form-control" placeholder="Enter todo">
    </div>
    <button type="submit" class="btn btn-submit-todo" (click)="onSubmitTodo(inputTodo.value)">Submit</button>
  </div>
</dx-popover>
